# personal_blog
## Стек проекта
Проект написан на Django Rest Framework + PostgreSQL + Celery + Docker

## Описание проекта
Блог с возможностью подписки на посты других пользователей.
У пользователя есть персональная лента новостей (не более ~500 постов), в которой выводятся посты из блогов, на которые он подписан,
также из ленты исключаются уже просмотренные посты.Подробнее в [файле](https://github.com/denis200/personal_blog/blob/main/%D0%A2%D0%B5%D1%81%D1%82%D0%BE%D0%B2%D0%BE%D0%B5%20%D0%B7%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5%20backend.docx)

## Installation

Для начала переименуйте  ".env.example"  - > ".env" 

После создайте базу данных postgres и в данный файл введите соответствующие поля.
```
POSTGRES_DB=#db credentials
POSTGRES_PASSWORD=#db credentials
```
Чтобы поднять контейнер, выполните команду:
```
docker-compose up --build
```

Для того чтобы выполнить заполнение базы тестовыми данными(Создается 10000 пользователей и блогов,
также создается модель админа, который подписан на 10000 других аккаунтов): 

```
docker exec web_django python manage.py setup_test_data
```

Данные для админа: 
\
email: admin@mail.ru\
password: Password2022


## API endpoints
### Users

POST [/api/v1/auth/users/]() - Регистрация пользователя
```
{
    "username": "",
    "email": "",
    "password": ""
}
```
POST [/api/v1/auth/jwt/create/]() - Авторизация
```
{
    "email":"",
    "password":""
}
```
### CRUD Постов

 GET [api/v1/blog/post/]() - Получить список всех постов\
 POST [api/v1/blog/post/]() - Добавить пост
```
{
    "title":"Заголовок поста",
    "text":"Содержание поста",
    "blog": id блога
}
```

PUT [api/v1/blog/post/<int:pk>]() - Обновить информацию о посте\
DELETE [api/v1/blog/post/<int:pk>]() - Удалить пост

### Лента постов пользователя

 GET [api/v1/blog/wall]() - Лента постов


### Подписаться на блог /Отписаться от блога

POST [api/v1/follower/blog_id]() - Подписаться на блог\
DELETE [api/v1/follower/blog_id]() - Отписаться от блога.

### Просмотреть пост / Убрать из списка просмотренных

POST [api/v1/blog/viewpost/post_id]() - Просмотреть пост\
DELETE [api/v1/blog/viewpost/post_id]() - Убрать из списка просмотренных.

## Немного о работе приложения
При создании пользователя автоматически создается его блог, в блоге есть возможность подсчитывать посты (по умолчанию она закоментирована, из за тестового режима), находится в blog/signals.py.
Также при создании пользователя создается celery задача, которая раз в день выводит в консоль последние 5 новостей(значение можно изменить).


